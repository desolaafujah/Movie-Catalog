"use strict";var v=Object.create;var g=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var P=Object.getPrototypeOf,J=Object.prototype.hasOwnProperty;var C=(o,t,a,m)=>{if(t&&typeof t=="object"||typeof t=="function")for(let u of O(t))!J.call(o,u)&&u!==a&&g(o,u,{get:()=>t[u],enumerable:!(m=x(t,u))||m.enumerable});return o};var d=(o,t,a)=>(a=o!=null?v(P(o)):{},C(t||!o||!o.__esModule?g(a,"default",{value:o,enumerable:!0}):a,o));var y=d(require("minimist"));var p=require("common-tags"),S=d(require("update-notifier"));var A=1e3*60*60*24*7;function f(){let o=p.stripIndent`
    Usage
      $ git delete-coauthor <co-author-initials>
    Options
      -h  Prints usage information
    Examples
      $ git delete-coauthor jd  # deletes John Doe to coauthors file

  `;console.log(o)}var n=require("fs"),h=require("util"),c=require("git-mob-core");function w({name:o,email:t}){return`${o} <${t}>`}function $(o,t,a){async function m(e){let r=o||(0,h.promisify)(n.readFile);try{return await r(e,"utf8")}catch(i){throw new Error(i.message)}}async function u(e,r){let i=t||(0,h.promisify)(n.appendFile);try{return await i(e,r,"utf8")}catch(s){throw new Error(s.message)}}async function j(e,r){let i=a||(0,h.promisify)(n.writeFile);try{return await i(e,r,"utf8")}catch(s){throw new Error(s.message)}}return{read:async()=>{let e=await m((0,c.pathToCoAuthors)());try{return JSON.parse(e)}catch(r){throw new Error("Invalid JSON "+r.message)}},write:async e=>{try{return u((0,c.pathToCoAuthors)(),JSON.stringify(e,null,2))}catch(r){throw new Error("Invalid JSON "+r.message)}},overwrite:async e=>{try{return j((0,c.pathToCoAuthors)(),JSON.stringify(e,null,2))}catch(r){throw new Error("Invalid JSON "+r.message)}},fileExists:()=>(0,n.existsSync)((0,c.pathToCoAuthors)()),author(e,r){let{coauthors:i}=r;return U(e,i),i[e]},coAuthorsInitials(e,r){let{coauthors:i}=e;return Object.keys(i).reduce((s,l)=>(r.includes(w(i[l]))&&s.push(l),s),[])},toList(e){return Object.entries(e.coauthors).map(i=>{let[s,{name:l,email:E}]=i;return[s,l,E].join(" ")})}}}function U(o,t){if(!(o in t))throw new Error(`Author with initials "${o}" not found!`)}async function b(o){let t=$(),a=await t.read();o in a.coauthors?(delete a.coauthors[o],await t.overwrite(a),console.log(o+": has been removed from .git-coauthors")):console.error(o+": no such initials in .git-coauthors")}var N=(0,y.default)(process.argv.slice(2),{alias:{h:"help"}});async function D(o){o.help&&(f(),process.exit(0));let t=o._;t.length===0&&console.error("Please provide the initials of who you want deleting. Use -h to view examples."),await b(t[0]),process.exit(0)}D(N);
